{"mappings":"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","sources":["src/js/WorkoutView.js","src/config/globalConfig.js","src/js/RunningView.js","src/js/CyclingView.js","src/js/StorageView.js","src/js/Markup.js","src/js/app.js","src/js/UIView.js"],"sourcesContent":["import { locale } from \"../config/globalConfig.js\";\r\n\r\nexport default class Workout {\r\n  //\r\n  date = new Date();\r\n  id = (Date.now() + \"\").slice(-10);\r\n\r\n  constructor(coords, distance, duration) {\r\n    this.coords = coords;\r\n    this.distance = distance;\r\n    this.duration = duration;\r\n  }\r\n\r\n  _setDescription() {\r\n    const optionsDate = {\r\n      hour: \"numeric\",\r\n      minute: \"numeric\",\r\n      day: \"numeric\",\r\n      month: \"long\",\r\n      year: \"numeric\",\r\n    };\r\n\r\n    //prettier-ignore\r\n    const formatedDate = new Intl.DateTimeFormat(locale, optionsDate).format(this.date);\r\n\r\n    this.description = `${\r\n      this.type === \"running\" ? \"دویدن\" : \"دوچرخه سواری\"\r\n    } در ${formatedDate}`;\r\n  }\r\n}\r\n","export const locale = \"fa-IR\";\r\n","import Workout from \"./WorkoutView.js\";\r\n\r\nexport default class Running extends Workout {\r\n  //\r\n  type = \"running\";\r\n\r\n  constructor(coords, distance, duration, cadence) {\r\n    super(coords, distance, duration);\r\n    this.cadence = cadence;\r\n    this.calcPace();\r\n    this._setDescription();\r\n  }\r\n  calcPace() {\r\n    // min / km\r\n    this.pace = this.duration / this.distance;\r\n    return this.pace;\r\n  }\r\n}\r\n","import Workout from \"./WorkoutView.js\";\r\n\r\nexport default class Cycling extends Workout {\r\n  //\r\n  type = \"cycling\";\r\n\r\n  constructor(coords, distance, duration, elevationGain) {\r\n    super(coords, distance, duration);\r\n    this.elevationGain = elevationGain;\r\n    this.calcSpeed();\r\n    this._setDescription();\r\n  }\r\n\r\n  calcSpeed() {\r\n    this.speed = this.distance / this.duration;\r\n    return this.speed;\r\n  }\r\n}\r\n","import Cycling from \"./CyclingView.js\";\r\nimport Running from \"./RunningView.js\";\r\n\r\nclass StorageView {\r\n  _setLocalStorag(workoutArr) {\r\n    localStorage.setItem(\"workouts\", JSON.stringify(workoutArr));\r\n  }\r\n\r\n  _getLocalStorage() {\r\n    const allData = JSON.parse(localStorage.getItem(\"workouts\"));\r\n\r\n    if (!allData) return [];\r\n\r\n    allData.forEach((data) => {\r\n      if (data.type === \"running\") Object.setPrototypeOf(data, Running);\r\n      if (data.type === \"cycling\") Object.setPrototypeOf(data, Cycling);\r\n    });\r\n\r\n    return allData;\r\n  }\r\n}\r\n\r\nexport default new StorageView();\r\n","class Markup {\r\n  _generateMarkup(workout, container) {\r\n    let html = `\r\n    <li class=\"workout workout__${workout.type}\" data-id=\"${workout.id}\">\r\n      <a href=\"#\" class=\"workout__del\"><i class=\"fa fa-trash\"></i></a>\r\n      <a href=\"#\" class=\"workout__change\"><i class=\"fa fa-edit\"></i></a>\r\n      <h2 class=\"workout__title\">${workout.description}</h2>\r\n      <div class=\"workout__detail\">\r\n        <span class=\"workou_unit\">km</span>\r\n        <span class=\"workou_value\">${workout.distance}</span>\r\n        <span class=\"workou_icon\">${\r\n          workout.type === \"running\" ? \"🏃‍♂️\" : \"🚲\"\r\n        }</span>\r\n      </div>\r\n      <div class=\"workout__detail\">\r\n        <span class=\"workou_unit\">MIN</span>\r\n        <span class=\"workou_value\">${workout.duration}</span>\r\n        <span class=\"workou_icon\">⌚</span>\r\n      </div>\r\n    `;\r\n\r\n    if (workout.type === \"running\") {\r\n      html += `\r\n          <div class=\"workout__detail\">\r\n          <span class=\"workou_unit\">MIN/KM</span>\r\n          <span class=\"workou_value\">${workout.pace.toFixed(1)} </span>\r\n          <span class=\"workou_icon\">⚡</span>\r\n        </div>\r\n        <div class=\"workout__detail\">\r\n          <span class=\"workou_unit\">SPM</span>\r\n          <span class=\"workou_value\">${workout.cadence} </span>\r\n          <span class=\"workou_icon\">👣</span>\r\n        </div>\r\n      </li>\r\n      `;\r\n    }\r\n\r\n    if (workout.type === \"cycling\") {\r\n      html += `\r\n          <div class=\"workout__detail\">\r\n          <span class=\"workou_unit\">KM/H</span>\r\n          <span class=\"workou_value\">${workout.speed.toFixed(1)}</span>\r\n          <span class=\"workou_icon\">⚡</span>\r\n        </div>\r\n        <div class=\"workout__detail\">\r\n          <span class=\"workou_unit\">M</span>\r\n          <span class=\"workou_value\">${workout.elevationGain}</span>\r\n          <span class=\"workou_icon\">🗻</span>\r\n        </div>\r\n      </li>\r\n      `;\r\n    }\r\n\r\n    container.insertAdjacentHTML(\"afterend\", html);\r\n  }\r\n}\r\n\r\nexport default new Markup();\r\n","import Running from \"./RunningView.js\";\r\nimport Cycling from \"./CyclingView.js\";\r\nimport UIView from \"./UIView.js\";\r\nimport StorageView from \"./StorageView.js\";\r\nimport Markup from \"./Markup.js\";\r\n\r\nconst modalContent = document.querySelector(\".modal__content p\");\r\n\r\n//form selection\r\nconst workouContainer = document.querySelector(\".workouts__container\");\r\nconst form = document.querySelector(\".form\");\r\nconst distanceInput = document.querySelector(\".distance__input\");\r\nconst durationInput = document.querySelector(\".duration__input\");\r\nconst cadenceInput = document.querySelector(\".cadence__input\");\r\nconst elevationInput = document.querySelector(\".elevation__input\");\r\nconst typeInput = document.querySelector(\"#type_workout\");\r\n\r\nconst modalElem = document.querySelector(\".modal\");\r\n\r\nexport default class App extends UIView {\r\n  //define variables\r\n  #map;\r\n  #mapEvent;\r\n  #mapMarkerArray = [];\r\n  #workouts = [];\r\n  #mapZoomLevel = 13;\r\n\r\n  constructor() {\r\n    super();\r\n    this._getPosition();\r\n    this._getLocalStorage();\r\n    // set value of select input of type\r\n    typeInput.value = \"running\";\r\n\r\n    form.addEventListener(\"submit\", this._newWorkout.bind(this));\r\n    //prettier-ignore\r\n    workouContainer.addEventListener(\"click\", this._moveToPopup.bind(this));\r\n    //prettier-ignore\r\n    workouContainer.addEventListener(\"click\",this._workoutElemEventhandler.bind(this));\r\n    // select chande & toggle inputs\r\n    typeInput.addEventListener(\"change\", this._toggleElevationField);\r\n  }\r\n\r\n  _newWorkout(e) {\r\n    //prettier-ignore\r\n    const validInputs = (...inputs) => inputs.every((inp) => Number.isFinite(inp));\r\n    const isAllPositive = (...inputs) => inputs.every((inp) => inp > 0);\r\n\r\n    e.preventDefault();\r\n\r\n    // Get data of form\r\n    const type = typeInput.value;\r\n    const distance = +distanceInput.value;\r\n    const duration = +durationInput.value;\r\n    const { lat, lng } = this.#mapEvent.latlng;\r\n    let workout;\r\n\r\n    let elevation;\r\n    let cadence;\r\n\r\n    if (type === \"running\") {\r\n      cadence = +cadenceInput.value;\r\n\r\n      //gard\r\n      // prettier-ignore\r\n      if ( !validInputs(distance, duration, cadence) || !isAllPositive(distance, duration, cadence))\r\n        return this._modalHandler(modalElem);\r\n\r\n      workout = new Running([lat, lng], distance, duration, cadence);\r\n    }\r\n\r\n    if (type === \"cycling\") {\r\n      elevation = +elevationInput.value;\r\n\r\n      // Gard\r\n      // prettier-ignore\r\n      if ( !validInputs(distance, duration, elevation) || !isAllPositive(distance, duration)) \r\n      return this._modalHandler(modalElem);\r\n\r\n      workout = new Cycling([lat, lng], distance, duration, elevation);\r\n    }\r\n\r\n    //if flag is true => means the workout edited\r\n    let flag = false;\r\n\r\n    this.#workouts.some((work, index) => {\r\n      if (work.coords.includes(workout.coords[0])) {\r\n        workout = work;\r\n        this.#workouts.splice(index, 1);\r\n        this.#map.removeLayer(this.#mapMarkerArray[index]);\r\n        this.#mapMarkerArray.splice(index, 1);\r\n\r\n        flag = true;\r\n        return;\r\n      }\r\n    });\r\n\r\n    if (flag) {\r\n      // prettier-ignore\r\n      if (type === \"running\") workout = new Running([lat, lng], distance, duration, cadence);\r\n      // prettier-ignore\r\n      if (type === \"cycling\") workout = new Cycling([lat, lng], distance, duration, elevation);\r\n    }\r\n\r\n    this.#workouts.push(workout);\r\n    this._renderworkoutMarker(workout);\r\n    this._renderWorkout(workout, flag);\r\n    //hide form\r\n    this._hideForm();\r\n    this._toggleMenuHandler();\r\n\r\n    StorageView._setLocalStorag(this.#workouts);\r\n  }\r\n\r\n  _workoutElemEventhandler(e) {\r\n    //Gard\r\n    if (!this.#map) return;\r\n    //remove\r\n    if (e.target.className === \"fa fa-trash\") {\r\n      const deleteItem = e.target.closest(\".workout\");\r\n\r\n      const deleteIndex = this.#workouts.findIndex(\r\n        (workout) => workout.id === deleteItem.dataset.id\r\n      );\r\n\r\n      this.#workouts.splice(deleteIndex, 1);\r\n      // renders remain workout\r\n      this.append(workouContainer, this.#workouts);\r\n      // update localstorage\r\n      StorageView._setLocalStorag(this.#workouts);\r\n      //delete marker\r\n      this.#map.removeLayer(this.#mapMarkerArray[deleteIndex]);\r\n      this.#mapMarkerArray.splice(deleteIndex, 1);\r\n    }\r\n\r\n    //change\r\n    if (e.target.className === \"fa fa-edit\") {\r\n      form.classList.remove(\"hidden\");\r\n      const index = e.target.closest(\".workout\");\r\n      //prettier-ignore\r\n      const itemEditIndex = this.#workouts.findIndex(workout => workout.id === index.dataset.id);\r\n      // const itemEditIndex = this.#workouts.find(editWork => editWork.id === deleteItem.dataset.id);\r\n      this.#mapEvent = this.#mapMarkerArray[itemEditIndex];\r\n      this.#mapEvent.latlng = this.#mapEvent._latlng;\r\n    }\r\n  }\r\n\r\n  _getPosition() {\r\n    if (navigator.geolocation) {\r\n      //prettier-ignore\r\n      navigator.geolocation.getCurrentPosition(this._loadMap.bind(this), geoError.bind(this));\r\n    }\r\n    //Error handler\r\n    function geoError() {\r\n      modalContent.textContent = `دسترسی به موقعیت مکانی ممکن نیست!`;\r\n      this._modalHandler(modalElem);\r\n    }\r\n  }\r\n\r\n  _loadMap(position) {\r\n    const { latitude, longitude } = position.coords;\r\n    const coords = [latitude, longitude];\r\n\r\n    this.#map = L.map(\"map\").setView(coords, this.#mapZoomLevel);\r\n\r\n    L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n      attribution:\r\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n    }).addTo(this.#map);\r\n\r\n    // handling mark on map\r\n    this.#map.on(\"click\", this._showForm.bind(this));\r\n\r\n    // render markers\r\n    this.#workouts.forEach((work) => this._renderworkoutMarker(work));\r\n  }\r\n\r\n  _renderworkoutMarker(workout) {\r\n    const options = {\r\n      maxWidth: 250,\r\n      minWidth: 100,\r\n      autoClose: false,\r\n      closeOnClick: false,\r\n      className: `${workout.type}-popup`,\r\n    };\r\n\r\n    let newMarker = L.marker(workout.coords, { draggable: true })\r\n      .addTo(this.#map)\r\n      .bindPopup(L.popup(options))\r\n      .setPopupContent(`${workout.description}`)\r\n      .openPopup();\r\n\r\n    newMarker.on(\"dragend\", this._newCoordsMarker.bind(this, workout));\r\n    this.#mapMarkerArray.push(newMarker);\r\n  }\r\n\r\n  _newCoordsMarker(workout, e) {\r\n    const { lat: newLat, lng: newLng } = e.target._latlng;\r\n    const newCoords = [newLat, newLng];\r\n\r\n    //set new coords\r\n    this.#workouts.forEach((newWorkMark) => {\r\n      if (workout.id === newWorkMark.id) {\r\n        newWorkMark.coords = newCoords;\r\n      }\r\n    });\r\n\r\n    StorageView._setLocalStorag(this.#workouts);\r\n  }\r\n\r\n  _renderWorkout(workout, flag = false) {\r\n    // if the workout is edited replace the new to\r\n    if (flag) {\r\n      this.append(workouContainer, this.#workouts);\r\n    } else {\r\n      Markup._generateMarkup(workout, form);\r\n    }\r\n  }\r\n\r\n  append(ItemContainer, workoutArray) {\r\n    const form = workouContainer.firstElementChild;\r\n    ItemContainer.innerHTML = \"\";\r\n    ItemContainer.appendChild(form);\r\n\r\n    workoutArray.forEach((work) => Markup._generateMarkup(work, form));\r\n  }\r\n\r\n  _moveToPopup(e) {\r\n    //Gard\r\n    if (!this.#map) return;\r\n\r\n    const workouElem = e.target.closest(\".workout\");\r\n\r\n    if (!workouElem) return;\r\n\r\n    const workoutClicked = this.#workouts.find(\r\n      (work) => work.id === workouElem.dataset.id\r\n    );\r\n\r\n    if (!workoutClicked) return;\r\n\r\n    const setViewOptions = {\r\n      animate: true,\r\n      pan: { duration: 1 },\r\n    };\r\n\r\n    //prettier-ignore\r\n    this.#map.setView(workoutClicked.coords, this.#mapZoomLevel, setViewOptions);\r\n  }\r\n\r\n  _getLocalStorage() {\r\n    this.#workouts = StorageView._getLocalStorage();\r\n    \r\n    this.#workouts.forEach((work) => this._renderWorkout(work));\r\n  }\r\n\r\n  _showForm(mapE) {\r\n    this.#mapEvent = mapE;\r\n    form.classList.remove(\"hidden\");\r\n    durationInput.focus();\r\n    this._toggleMenuHandler();\r\n  }\r\n\r\n  _hideForm() {\r\n    //prettier-ignore\r\n    distanceInput.value = durationInput.value = elevationInput.value = cadenceInput.value = '';\r\n    form.classList.add(\"hidden\");\r\n  }\r\n\r\n  _toggleElevationField() {\r\n    elevationInput.closest(\".form__row\").classList.toggle(\"form__row_hidden\");\r\n    cadenceInput.closest(\".form__row\").classList.toggle(\"form__row_hidden\");\r\n  }\r\n}\r\n\r\nconst app = new App();\r\n","export default class UIView {\r\n  _toggleMenu = document.querySelector(\".toggler__menu\");\r\n  _menuOverlay = document.querySelector(\".menu__overlay\");\r\n  _closeMenuBtn = document.querySelector(\".close__menu--btn\");\r\n  _form = document.querySelector(\".form\");\r\n\r\n  _modalClose = document.querySelector(\".modal i.fa-close\");\r\n  _modalDetailBtn = document.querySelector(\".modal_datail_close\");\r\n  _modalOverlay = document.querySelector(\".modal__overlay\");\r\n\r\n  _menu = document.querySelector(\".menu\");\r\n  _modalDetailElem = document.querySelector(\".modal__info\");\r\n  _modalElem = document.querySelector(\".modal\");\r\n\r\n  _aboutAppBtn = document.querySelector(\".about__app\");\r\n\r\n  constructor() {\r\n    // menu handler\r\n    this._toggleMenu.addEventListener(\r\n      \"click\",\r\n      this._toggleMenuHandler.bind(this)\r\n    );\r\n\r\n    this._menuOverlay.addEventListener(\r\n      \"click\",\r\n      this._toggleMenuHandler.bind(this)\r\n    );\r\n\r\n    this._closeMenuBtn.addEventListener(\r\n      \"click\",\r\n      this._toggleMenuHandler.bind(this)\r\n    );\r\n\r\n    //modal close\r\n    this._modalClose.addEventListener(\r\n      \"click\",\r\n      this._modalCloseHandler.bind(this)\r\n    );\r\n\r\n    this._modalDetailBtn.addEventListener(\r\n      \"click\",\r\n      this._modalDetailClose.bind(this)\r\n    );\r\n\r\n    this._modalOverlay.addEventListener(\r\n      \"click\",\r\n      this._modalCloseHandler.bind(this)\r\n    );\r\n\r\n    this._aboutAppBtn.addEventListener(\r\n      \"click\",\r\n      this._modalHandler.bind(this, this._modalDetailElem)\r\n    );\r\n\r\n    document.addEventListener(\r\n      \"keydown\",\r\n      function (e) {\r\n        if (e.key === \"Escape\") this._toggleMenuHandler();\r\n      }.bind(this)\r\n    );\r\n  }\r\n\r\n  _toggleMenuHandler() {\r\n    this._menu.classList.toggle(\"menu__isActive\");\r\n    this._menuOverlay.classList.toggle(\"overlay--active\");\r\n\r\n    if (\r\n      !this._form.classList.contains(\"hidden\") &&\r\n      !this._menu.classList.contains(\"menu__isActive\")\r\n    ) {\r\n      this._form.classList.add(\"hidden\");\r\n      this._form.classList.add(\"hidden\");\r\n    }\r\n  }\r\n\r\n  _modalCloseHandler() {\r\n    this._modalElem.classList.add(\"hidden_modal\");\r\n    this._modalDetailElem.classList.add(\"hidden_modal\");\r\n    this._modalOverlay.classList.remove(\"overlay--active\");\r\n  }\r\n\r\n  _modalDetailClose() {\r\n    this._modalDetailElem.classList.add(\"hidden_modal\");\r\n    this._modalOverlay.classList.remove(\"overlay--active\");\r\n  }\r\n\r\n  _modalHandler(modalElement) {\r\n    modalElement.classList.remove(\"hidden_modal\");\r\n    this._modalOverlay.classList.add(\"overlay--active\");\r\n\r\n    if (modalElement.classList.contains(\"modal\"))\r\n      setTimeout(() => {\r\n        modalElement.classList.add(\"hidden_modal\");\r\n        this._modalOverlay.classList.remove(\"overlay--active\");\r\n      }, 5000);\r\n  }\r\n}\r\n"],"names":["$482241c080094a1f$export$2e2bcd8739ae039","date","Date","id","now","slice","constructor","coords","distance","duration","this","_setDescription","formatedDate","Intl","DateTimeFormat","hour","minute","day","month","year","format","description","type","$9b4c1cb264557bf9$export$2e2bcd8739ae039","cadence","super","calcPace","pace","$0b6ac935bcc2057e$export$2e2bcd8739ae039","elevationGain","calcSpeed","speed","$5d72e81e23e7e852$export$2e2bcd8739ae039","_setLocalStorag","workoutArr","localStorage","setItem","JSON","stringify","_getLocalStorage","allData","parse","getItem","forEach","data","Object","setPrototypeOf","_generateMarkup","workout","container","html","$388b617130f03bd4$var$modalContent","document","querySelector","$388b617130f03bd4$var$workouContainer","$388b617130f03bd4$var$form","$388b617130f03bd4$var$distanceInput","$388b617130f03bd4$var$durationInput","$388b617130f03bd4$var$cadenceInput","$388b617130f03bd4$var$elevationInput","$388b617130f03bd4$var$typeInput","$388b617130f03bd4$var$modalElem","_toggleMenu","_menuOverlay","_closeMenuBtn","_form","_modalClose","_modalDetailBtn","_modalOverlay","_menu","_modalDetailElem","_modalElem","_aboutAppBtn","addEventListener","_toggleMenuHandler","bind","_modalCloseHandler","_modalDetailClose","_modalHandler","e","key","classList","toggle","contains","add","remove","modalElement","setTimeout","map","mapEvent","mapMarkerArray","workouts","mapZoomLevel","_getPosition","value","_newWorkout","_moveToPopup","_workoutElemEventhandler","_toggleElevationField","validInputs","inputs","every","inp","Number","isFinite","isAllPositive","preventDefault","lat","lng","latlng","elevation","flag","some","work","index","includes","splice","removeLayer","push","_renderworkoutMarker","_renderWorkout","_hideForm","target","className","deleteItem","closest","deleteIndex","findIndex","dataset","append","itemEditIndex","_latlng","navigator","geolocation","getCurrentPosition","_loadMap","textContent","position","latitude","longitude","L","setView","tileLayer","attribution","addTo","on","_showForm","options","maxWidth","minWidth","autoClose","closeOnClick","newMarker","marker","draggable","bindPopup","popup","setPopupContent","openPopup","_newCoordsMarker","newLat","newLng","newCoords","newWorkMark","$8f6309521505cade$export$2e2bcd8739ae039","ItemContainer","workoutArray","form1","firstElementChild","innerHTML","appendChild","workouElem","workoutClicked","find","animate","pan","mapE","focus"],"version":3,"file":"index.e3a34ea4.js.map"}